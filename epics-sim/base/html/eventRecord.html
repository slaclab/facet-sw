<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
     'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>

<html>
<head>
<title>Event&#x20;Record&#x20;(event)</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link rel='stylesheet' href='style.css' type='text/css'>
</head>
<body>


<div class="pod">

<h1 id="Event-Record-event">Event Record (event)</h1>

<p>The normal use for this record type is to post an event and/or process a forward link. Device support for this record can provide a hardware interrupt handler routine for I/O Event-scanned records.</p>

<h2 id="Parameter-Fields">Parameter Fields</h2>

<p>The records in this field fall into the following groups of parameters:</p>

<ul>

<li><p>scan parameters</p>

</li>
<li><p>read parameters</p>

</li>
<li><p>event number parameters</p>

</li>
<li><p>simulation mode parameters</p>

</li>
</ul>

<h3 id="Scan-Parameters">Scan Parameters</h3>

<p>The event record has the standard fields for specifying under what circumstances it will be processed. If the SCAN field specifies <code>I/O Intr</code>, then device support will provide an interrupt handler, posting an event number when an I/O interrupt occurs. These fields are listed in <a href="#Scan-Fields">&quot;Scan Fields&quot;</a>. In addition, <a href="#Scanning-Specification">&quot;Scanning Specification&quot;</a> explains how the scanning fields work. Note that I/O event scanning is only supported for those card types that interrupt.</p>

<h3 id="Event-Number-Parameters">Event Number Parameters</h3>

<p>The VAL field contains the event number read by the device support routines. It is this number which is posted. For records that use <code>Soft Channel</code> device support, it can be configured before run-time or set via dbPuts.</p>

<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">VAL</td><td class="cell">Event Name To Post</td><td class="cell">STRING [40]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>

<h3 id="Input-Specification">Input Specification</h3>

<p>The device support routines use the address in this record to obtain input. For records that provide an interrupt handler, the INP field should specify the address of the I/O card, and the DTYP field should specify a valid device support module. Be aware that the address format differs according to the card type used. See <a href="#Address-Specification">&quot;Address Specification&quot;</a> for information on the format of hardware addresses and specifying links.</p>

<p>For soft records, the INP field can be a constant, a database link, or a channel access link. For soft records, the DTYP field should specify <code>Soft Channel</code>.</p>

<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">INP</td><td class="cell">Input Specification</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">DTYP</td><td class="cell">Device Type</td><td class="cell">DEVICE</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>

<h3 id="Operator-Display-Parameters">Operator Display Parameters</h3>

<p>See <a href="#Fields-Common-to-All-Record-Types">&quot;Fields Common to All Record Types&quot;</a> for more on the record name (NAME) and description (DESC) fields.</p>

<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">NAME</td><td class="cell">Record Name</td><td class="cell">STRING [61]</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DESC</td><td class="cell">Descriptor</td><td class="cell">STRING [41]</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>

<h3 id="Alarm-Parameters">Alarm Parameters</h3>

<p>The Event record has the alarm parameters common to all record types. <a href="#Alarm-Fields">&quot;Alarm Fields&quot;</a> lists other fields related to alarms that are common to all record types.</p>

<h3 id="Simulation-Mode-Parameters">Simulation Mode Parameters</h3>

<p>The following fields are used to operate the event record in the simulation mode. See <a href="#Fields-Common-to-Many-Record-Types">&quot;Fields Common to Many Record Types&quot;</a> for more information on these fields.</p>

<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">SIOL</td><td class="cell">Sim Input Specifctn</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SVAL</td><td class="cell">Simulation Value</td><td class="cell">STRING [40]</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIML</td><td class="cell">Sim Mode Location</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMM</td><td class="cell">Simulation Mode</td><td class="cell">MENU (<a href='menuYesNo.html'>menuYesNo</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">SIMS</td><td class="cell">Sim mode Alarm Svrty</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>

<h2 id="Record-Support">Record Support</h2>

<h3 id="Record-Support-Routines">Record Support Routines</h3>

<h4 id="init_record">init_record</h4>

<p>This routine initializes SIMM with the value of SIML if SIML type is a CONSTANT link or creates a channel access link if SIML type is PV_LINK. SVAL is likewise initialized if SIOL is CONSTANT or PV_LINK.</p>

<p>If device support includes <code>init_record()</code>, it is called.</p>

<h4 id="process">process</h4>

<p>See next section.</p>

<h3 id="Record-Processing">Record Processing</h3>

<p>Routine process implements the following algorithm:</p>

<ol>

<li><p>readValue is called. See <a href="#Input-Records">&quot;Input Records&quot;</a> for more information.</p>

</li>
<li><p>If PACT has been changed to TRUE, the device support read routine has started but has not completed reading a new input value. In this case, the processing routine merely returns, leaving PACT TRUE.</p>

</li>
<li><p>If VAL &gt; 0, post event number VAL.</p>

</li>
<li><p>Check to see if monitors should be invoked. Alarm monitors are invoked if the alarm status or severity has chanet to 0.</p>

</li>
<li><p>Scan forward link if necessary, set PACT FALSE, and return.</p>

</li>
</ol>

<h2 id="Device-Support">Device Support</h2>

<h3 id="Fields-of-Interest-To-Device-Support">Fields of Interest To Device Support</h3>

<p>Each record must have an associated set of device support routines. The device support routines are primarily interested in the following fields:</p>

<blockquote><table border="1"><tr>
<th>Field</th><th>Summary</th><th>Type</th><th>DCT</th>
<th>Default</th><th>Read</th><th>Write</th><th>CA PP</th>
</tr>
<tr><td class="cell">PACT</td><td class="cell">Record active</td><td class="cell">UCHAR</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">DPVT</td><td class="cell">Device Private</td><td class="cell">NOACCESS</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">No</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">UDF</td><td class="cell">Undefined</td><td class="cell">UCHAR</td><td class="cell">Yes</td><td class="cell">1</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">Yes</td></tr>

<tr><td class="cell">NSEV</td><td class="cell">New Alarm Severity</td><td class="cell">MENU (<a href='menuAlarmSevr.html'>menuAlarmSevr</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">NSTA</td><td class="cell">New Alarm Status</td><td class="cell">MENU (<a href='menuAlarmStat.html'>menuAlarmStat</a>)</td><td class="cell">No</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">No</td><td class="cell">No</td></tr>

<tr><td class="cell">INP</td><td class="cell">Input Specification</td><td class="cell">INLINK</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

<tr><td class="cell">PRIO</td><td class="cell">Scheduling Priority</td><td class="cell">MENU (<a href='menuPriority.html'>menuPriority</a>)</td><td class="cell">Yes</td><td class="cell">&nbsp;</td><td class="cell">Yes</td><td class="cell">Yes</td><td class="cell">No</td></tr>

</table></blockquote>

<h3 id="Device-Support-Routines">Device Support Routines</h3>

<p>Device support consists of the following routines:</p>

<h4 id="long-report-int-level">long report(int level)</h4>

<p>This optional routine is called by the IOC command <code>dbior</code> and is passed the report level that was requested by the user. It should print a report on the state of the device support to stdout. The <code>level</code> parameter may be used to output increasingly more detailed information at higher levels, or to select different types of information with different levels. Level zero should print no more than a small summary.</p>

<h4 id="long-init-int-after">long init(int after)</h4>

<p>This optional routine is called twice at IOC initialization time. The first call happens before any of the <code>init_record()</code> calls are made, with the integer parameter <code>after</code> set to 0. The second call happens after all of the <code>init_record()</code> calls have been made, with <code>after</code> set to 1.</p>

<h4 id="init_record1">init_record</h4>

<pre><code>  init_record(precord)</code></pre>

<p>This routine is optional. If provided, it is called by the record support <code>init_record()</code> routine.</p>

<h4 id="get_ioint_info">get_ioint_info</h4>

<pre><code>  get_ioint_info(int cmd, struct dbCommon *precord, IOSCANPVT *ppvt)</code></pre>

<p>This routine is called by the ioEventScan system each time the record is added or deleted from an I/O event scan list. cmd has the value (0,1) if the record is being (added to, deleted from) an I/O event list. It must be provided for any device type that can use the ioEvent scanner.</p>

<h4 id="read_event">read_event</h4>

<pre><code>  read_event(precord)</code></pre>

<p>This routine returns the following values:</p>

<ul>

<li><p>0: Success.</p>

</li>
<li><p>Other: Error.</p>

</li>
</ul>

<h3 id="Device-Support-For-Soft-Records">Device Support For Soft Records</h3>

<p>The <code>Soft Channel</code> device support module is available. The INP link type must be either CONSTANT, DB_LINK, or CA_LINK.</p>

<p>If the INP link type is CONSTANT, then the constant value is stored into VAL by <code>init_record()</code>, and UDF is set to FALSE. If the INP link type is PV_LINK, then dbCaAddInlink is called by <code>init_record()</code>.</p>

<p><code>read_event</code> calls recGblGetLinkValue to read the current value of VAL. See <a href="#Input-Records">&quot;Input Records&quot;</a> for details on soft input.</p>

</div>

</body>
</html>

